# CRMシート統合セットアップガイド

## 概要

CRMスプレッドシートは単一の「リード管理」シート（39列）で全データを管理します。

**シート構成**
- リード管理（メインシート：39列）
- 担当者マスタ
- 設定
- 権限設定
- 目標設定
- ダッシュボード
- テンプレート
- 通知設定

## 進捗ステータス

単一シート内での「進捗ステータス」列により、リードの段階を管理します。

| 段階 | ステータス | 説明 |
|------|------------|------|
| リード段階 | 新規 | 登録直後、未対応 |
| リード段階 | 対応中 | CSが対応中、アサイン前 |
| 商談段階 | アサイン済 | 営業担当にアサイン完了 |
| 商談段階 | 商談中 | 営業が商談対応中 |
| 完了段階 | 成約 | 契約成立 |
| 完了段階 | 失注 | 商談不成立 |
| 完了段階 | 保留 | 一時的に保留 |
| 完了段階 | 対象外 | 見込みなし、対象外 |

## セットアップ手順

### Step 1: コードのプッシュ

```bash
cd /Users/tanizawashingo/sales-ops-with-claude/crm-dashboard
clasp push
```

### Step 2: 統合シートの作成

Google スプレッドシートを開き、以下の関数を**手動で実行**します：

1. **Apps Scriptエディタを開く**
   - スプレッドシートの「拡張機能」→「Apps Script」

2. **関数を実行**
   ```
   実行する関数: setupIntegratedLeadSheet
   ```

   これにより「リード管理」シートが作成されます（39列構成）。

### Step 3: テストデータの追加（任意）

テスト用にサンプルデータを追加する場合：

```
実行する関数: addTestLeads
```

## 手動実行関数一覧

| 関数名 | 説明 |
|--------|------|
| `setupIntegratedLeadSheet` | 統合シート「リード管理」を作成 |
| `addTestLeads` | テスト用のサンプルリードを追加 |

## 統合シート列構成（39列）

```
1. リードID           - 自動（LD-00001形式）
2. 登録日             - 自動
3. リード種別         - インバウンド/アウトバウンド
4. 流入経路           - プルダウン（設定シート参照）
5. 会社名             - テキスト
6. 顧客名             - テキスト
7. 呼び方（英語）     - テキスト
8. 国                 - プルダウン
9. メール             - テキスト
10. 電話番号          - テキスト
11. SNS/連絡手段      - テキスト
12. メッセージURL     - テキスト
13. 進捗ステータス    - 新規/対応中/アサイン済/商談中/成約/失注/保留/対象外
14. 担当者            - プルダウン（担当者マスタ参照）
15. 担当者ID          - 自動
16. アサイン日        - 自動
17. 初回接触日        - 日付
18. 温度感            - 高/中/低
19. 想定規模          - 大口/中規模/小口
20. 顧客タイプ        - 信頼重視/価格重視/不明
21. 返信速度          - 24h以内/48h以内/3日以上
22. 見込度            - 自動計算
23. 商談ステータス    - 初回連絡/提案中/見積中/クロージング
24. 次回アクション    - テキスト
25. 次回アクション日  - 日付
26. 商談メモ          - テキスト
27. 相手の課題        - テキスト
28. 取り扱いタイトル  - テキスト
29. 販売形態          - 実店舗/EC/ライブ配信/複合
30. 月間見込み金額    - 数値
31. 競合比較中        - はい/いいえ
32. 商談結果          - 成約/失注/追客/見送り/対象外
33. 初回取引日        - 日付
34. 初回取引金額      - 数値
35. 累計取引金額      - 自動計算
36. パートナーシップ度 - 1-5
37. 通知確認          - 自動
38. シート更新日      - 自動
39. 備考              - テキスト
```

## Webアプリケーション

スプレッドシートはデータベースとして使用。ユーザーは直接シートを操作せず、すべてWebアプリ経由でアクセスします。

### ページ構成

| ページ | 表示対象 |
|--------|----------|
| ダッシュボード | KPI概要 |
| リード（IN） | リード種別=インバウンド、進捗ステータス=新規/対応中 |
| リード（OUT） | リード種別=アウトバウンド、進捗ステータス=新規/対応中 |
| 商談管理 | 進捗ステータス=アサイン済/商談中 |
| 担当者管理 | 担当者マスタ |
| 管理者設定 | 権限・通知設定 |

## 注意事項

- スプレッドシートは直接編集しない（Webアプリ経由で操作）
- リードIDは自動採番（LD-00001形式）
- 担当者選択時に担当者IDが自動設定
- アサイン時にアサイン日が自動設定
